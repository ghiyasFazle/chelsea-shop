<!-- Simple confirm modal -->
<div id="confirmModal" class="hidden fixed inset-0 z-50 w-full flex items-center justify-center" style="background: rgba(0,0,0,0.5);">
  <div class="product-card w-11/12 sm:w-3/4 md:w-1/2 lg:w-1/3">
    <div class="flex items-start justify-between mb-4">
      <div>
        <h3 id="confirmTitle" class="text-lg font-semibold">Confirm action</h3>
        <p id="confirmSubtitle" class="text-sm text-gray-600">Are you sure?</p>
      </div>
      <button type="button" id="confirmCloseBtn" class="text-gray-500 hover:text-gray-900" aria-label="Close">Ã—</button>
    </div>

    <div class="mb-4">
      <p id="confirmMessage">Are you sure you want to delete this item? This action cannot be undone.</p>
    </div>

    <div class="flex justify-end gap-3 mt-3">
      <button type="button" id="confirmCancel" class="btn btn-light">Cancel</button>
      <button type="button" id="confirmOk" class="btn btn-primary">Yes, delete</button>
    </div>
  </div>
</div>

<script>
  (function(){
    const modal = document.getElementById('confirmModal');
    const closeBtn = document.getElementById('confirmCloseBtn');
    const cancelBtn = document.getElementById('confirmCancel');
    const okBtn = document.getElementById('confirmOk');
    let currentResolve = null;

    function showConfirm(message){
      document.getElementById('confirmMessage').textContent = message || 'Are you sure?';
      modal.classList.remove('hidden');
      return new Promise((resolve) => { currentResolve = resolve; });
    }

    function hide(){
      modal.classList.add('hidden');
      if(currentResolve) { currentResolve(false); currentResolve = null; }
    }

    closeBtn && closeBtn.addEventListener('click', hide);
    cancelBtn && cancelBtn.addEventListener('click', hide);
    modal && modal.addEventListener('click', function(e){ if(e.target===modal) hide(); });
    document.addEventListener('keydown', function(e){ if(e.key==='Escape') hide(); });

    okBtn && okBtn.addEventListener('click', function(){
      modal.classList.add('hidden');
      if(currentResolve){ currentResolve(true); currentResolve = null; }
    });

    // expose helpers
    window.showConfirmModal = showConfirm;
    window.hideConfirmModal = hide;
    // allow caller to set loading state on confirm modal
    window.setConfirmLoading = function(loading){
      if(!okBtn) return;
      okBtn.disabled = !!loading;
      okBtn.textContent = loading ? 'Processing...' : 'Yes, delete';
      if(loading) okBtn.classList.add('opacity-70'); else okBtn.classList.remove('opacity-70');
    };
  })();
</script>
